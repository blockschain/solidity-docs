



<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Solidity中文文档">
      
      
      
        <meta name="author" content="Nosy">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="zh">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.2.5">
    
    
      
        <title>常见问题 - Solidity文档</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.bcabdff3.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.792431c1.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    
      <body data-md-color-primary="indigo" data-md-color-accent="indigo">
    
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Solidity文档" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Solidity文档
              </span>
              <span class="md-header-nav__topic">
                常见问题
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/wohugb/solidity-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/solidty-docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="简介" class="md-tabs__link md-tabs__link--active">
        简介
      </a>
    
  </li>

      
        
      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../solidity-in-depth/" title="深入" class="md-tabs__link">
          深入
        </a>
      
    </li>
  

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Solidity文档
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/wohugb/solidity-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/solidty-docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="简介" class="md-nav__link">
      简介
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../introduction-to-smart-contracts/" title="智能合约" class="md-nav__link">
      智能合约
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../installing-solidity/" title="安装编译器" class="md-nav__link">
      安装编译器
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../solidity-by-example/" title="举例" class="md-nav__link">
      举例
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      深入
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        深入
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../solidity-in-depth/" title="概述" class="md-nav__link">
      概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../layout-of-source-files/" title="源文件布局" class="md-nav__link">
      源文件布局
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../structure-of-a-contract/" title="合约结构" class="md-nav__link">
      合约结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../types/" title="类型" class="md-nav__link">
      类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../units-and-global-variables/" title="单位和全局可用变量" class="md-nav__link">
      单位和全局可用变量
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../control-structures/" title="表达式和控制结构" class="md-nav__link">
      表达式和控制结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../contracts/" title="合约" class="md-nav__link">
      合约
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../assembly/" title="汇编" class="md-nav__link">
      汇编
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../miscellaneous/" title="杂项" class="md-nav__link">
      杂项
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../security-considerations/" title="安全考虑" class="md-nav__link">
      安全考虑
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../using-the-compiler/" title="使用编译器" class="md-nav__link">
      使用编译器
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contracts/" title="合约元数据" class="md-nav__link">
      合约元数据
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../abi-spec/" title="接口规范" class="md-nav__link">
      接口规范
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../julia/" title="JULIA" class="md-nav__link">
      JULIA
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../style-guide/" title="样式指南" class="md-nav__link">
      样式指南
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../common-patterns/" title="常见模式" class="md-nav__link">
      常见模式
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../bugs/" title="错误列表" class="md-nav__link">
      错误列表
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contributing/" title="贡献" class="md-nav__link">
      贡献
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        常见问题
      </label>
    
    <a href="./" title="常见问题" class="md-nav__link md-nav__link--active">
      常见问题
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" title="基本问题" class="md-nav__link">
    基本问题
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="高级问题" class="md-nav__link">
    高级问题
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" title="基本问题" class="md-nav__link">
    基本问题
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" title="高级问题" class="md-nav__link">
    高级问题
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="_1">常见问题<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>这份清单最初由<a href="mailto:fivedogit@gmail.com">fivedogit</a>编制.</p>
<h2 id="_2">基本问题<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<details class="faq"><summary>示例合约</summary><p>fivedogit写的一些<a href="https://github.com/fivedogit/solidity-baby-steps/tree/master/contracts/">合约例子</a>并且对于Solidity的每个特征都应该有一份<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/05_greeter.sol">测试合约</a>。</p></details><details class="faq"><summary>尽可能创建并发布最基本的合约</summary><p>一个非常简单的合约是<a href="https://github.com/ethereum/solidity/blob/develop/test/libsolidity/SolidityEndToEndTest.cpp">迎宾员</a></p></details><details class="faq"><summary>是否可以在特定的块号码上做些什么？（例如发布合约或执行交易）</summary><p>交易不保证在下一个块或任何未来的特定块上发生, 因为矿工需要包括交易，而不是交易的提交者.
这适用于函数调用/交易和合约创建交易.</p><p>如果您想要安排未来的合约通话时间，您可以使用<a href="http://www.ethereum-alarm-clock.com/">闹钟</a>.</p></details><details class="faq"><summary>什么是“有效载荷”交易？</summary><p>这只是与请求一起发送的字节码“数据”。</p></details><details class="faq"><summary>是否有反编译器可用？</summary><p>Solidity没有确切的反编译器, 但<a href="https://github.com/comaeio/porosity">孔隙度</a>很接近.
由于编译过程中会丢失某些信息，如变量名称，注释和源代码格式，因此无法完全恢复原始源代码。</p><p>字节码可以反汇编到操作码，一个由几个区块链探索者提供的服务.</p><p>区块链上的合约如果要由第三方使用，应该公布其原始源代码.</p></details><details class="faq"><summary>创建一个可以被杀死并返还资金的合约</summary><p>首先，警告一句话：杀死合约听起来像是一个好主意，因为“清理”总是很好，但从上面看，它并不真正清理。
此外，如果以太被派去拆除合约，以太将永远失去。</p><p>如果你想停用你的合约，最好通过改变导致所有函数抛出的内部状态来禁用它们。
这会使合约无法使用，并且发送给合约的乙醚将自动返回。</p><p>现在回答这个问题：在一个构造函数中，msg.sender是创建者。
保存。
然后<code>selfdestruct(creator);</code>杀死并返还资金。</p><p><a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/05_greeter.sol">例</a></p><p>Note that if you <code>import "mortal"</code> at the top of your contracts and declare <code>contract SomeContract is mortal { ...</code> and compile with a compiler that already has it (which includes <a href="https://remix.ethereum.org/">Remix</a>), then <code>kill[4]</code> is taken care of for you.
Once a contract is "mortal", then you can <code>contractname.kill.sendTransaction({from:eth.coinbase})</code>, just the same as my 示例.</p></details><details class="faq"><summary>将以太币存储在合约中</summary><p>诀窍是用`{from：someaddress，value：web3.toWei（3，“ether”）...}创建契约，</p><p>查看<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/30_endowment_retriever.sol">endowment_retriever.sol</a>.</p></details><details class="faq"><summary>使用非常量函数（req<code>sendTransaction</code>）来增加合约中的变量</summary><p>查看<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/20_value_incrementer.sol">value_incrementer.sol</a>.</p></details><details class="faq"><summary>得到一份合约把资金返还给你（不使用<code>selfdestruct（...）</code>）。</summary><p>这个例子演示了如何将资金从合同发送到地址。</p><p>查看<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/30_endowment_retriever.sol">endowment_retriever</a>.</p></details><details class="faq"><summary>你可以从一个稳定的函数调用返回一个数组或一个<code>string</code>吗？</summary><p>是的，查看<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/60_array_receiver_and_returner.sol">array_receiver_and_returner.sol</a>.</p><p>What is problematic, though, is returning any variably-sized data (e.g. a variably-sized array like <code>uint[]</code>) from  a fuction <strong>called from within Solidity</strong>.
This is a limitation of the EVM and will be solved with the next protocol update.</p><p>Returning variably-sized data as part of an external transaction or call is fine.</p></details><details class="faq"><summary>是否有可能像这样在线初始化一个数组：<code>string [] myarray = [“a”，“b”];</code></summary><p>是的，
但是应该指出的是，目前这只适用于静态大小的内存阵列。
你甚至可以在return语句中创建一个内联内存数组。
很酷，呵呵</p><p>例:</p><div class="codehilite"><pre><span></span>pragma solidity ^0.4.16;

contract C {
    function f[4] public pure returns (uint8[5]) {
        string[4] memory adaArr = [&quot;This&quot;, &quot;is&quot;, &quot;an&quot;, &quot;array&quot;];
        return ([1, 2, 3, 4, 5]);
    }
}
</pre></div>

</details><details class="faq"><summary>一个契约函数可以返回一个<code>struct</code>吗？</summary><p>是的，但只能在“内部”函数调用中使用。</p></details><details class="faq"><summary>如果我返回一个<code>enum</code>，我只在web3.js中获得整数值。,如何获得命名值？</summary><p>Enums are not supported by the ABI, they are just supported by Solidity.
You have to do the mapping yourself for now, we might provide some help later.</p></details><details class="faq"><summary>状态变量可以在线初始化吗？</summary><p>是的，这是可能的所有类型（即使是结构）。
但是，对于数组，应该注意，您必须将它们声明为静态内存数组。</p><p>示例:</p><div class="codehilite"><pre><span></span>pragma solidity ^0.4.0;

contract C {
    struct S {
        uint a;
        uint b;
    }

    S public x = S(1, 2);
    string name = &quot;Ada&quot;;
    string[4] adaArr = [&quot;This&quot;, &quot;is&quot;, &quot;an&quot;, &quot;array&quot;];
}

contract D {
    C c = new C[4];
}
</pre></div>

</details><details class="faq"><summary>结构如何工作？</summary><p>查看<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/65_struct_and_for_loop_tester.sol">struct_and_for_loop_tester.sol</a>.</p></details><details class="faq"><summary>循环如何工作？</summary><p>非常类似于JavaScrip
但有一点需要注意：</p><p>如果你使用<code>for（var i = 0; i &lt;a.length; i ++）{a [i] = i; ,}</code>，那么<code>i</code>的类型将只从'0<code>推断，其类型是</code>uint8<code>。
这意味着如果</code>a<code>具有多于255个元素，则您的循环将不会终止，因为</code>i<code>只能保持值高达</code>255`。</p><p>更好的使用<code>for (uint i = 0; i &lt; a.length...</code></p><p>查看<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/65_struct_and_for_loop_tester.sol">struct_and_for_loop_tester.sol</a>.</p></details><details class="faq"><summary>什么是基本字符串操作的一些例子（<code>substring</code>，<code>indexOf</code>，<code>charAt</code>等）？</summary><p><a href="https://github.com/ethereum/dapp-bin/blob/master/library/stringUtils.sol">stringUtils.sol</a>中有一些字符串实用程序函数，将来会进行扩展。
另外，Arachnid写了<a href="https://github.com/Arachnid/solidity-stringutils">solidity-stringutils</a>。</p><p>现在，如果你想修改一个字符串（即使你只想知道它的长度），你应该总是先把它转换成一个字节：</p><div class="codehilite"><pre><span></span>pragma solidity ^0.4.0;

contract C {
    string s;

    function append(byte c) public {
        bytes(s).push(c);
    }

    function set(uint i, byte c) public {
        bytes(s)[i] = c;
    }
}
</pre></div>

</details><details class="faq"><summary>我可以连接两个字符串吗？</summary><p>你现在必须手动完成。</p></details><details class="faq"><summary>为什么低级函数<code>.call（）</code>比实例化一个变量（<code>ContractB b;</code>）并执行它的函数（<code>b.doSomething（）;</code>）更合适？</summary><p>如果使用实际函数，编译器会告诉你类型或参数是否匹配，如果该函数不存在或不可见，那么它将为你打包参数。</p><p>查看<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/45_ping.sol">ping.sol</a>和<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/45_pong.sol">pong.sol</a>.</p></details><details class="faq"><summary>未使用的天然气是否自动退还？</summary><p>是的，它是直接的，即作为交易的一部分完成。</p></details><details class="faq"><summary>当返回<code>uint</code>类型的值时，是否可以返回一个'undefined`或者“null”类型的值？</summary><p>这是不可能的，因为所有类型都使用完整的值范围。</p><p>您可以选择在错误时抛出错误，这也将恢复整个事务，如果遇到意外情况，这可能是个好主意。</p><p>如果你不想扔，你可以返回一对：</p><div class="codehilite"><pre><span></span>pragma solidity ^0.4.16;

contract C {
    uint[] counters;

    function getCounter(uint index)
        public
        view
        returns (uint counter, bool error) {
            if (index &gt;= counters.length)
                return (0, true);
            else
                return (counters[index], false);
    }

    function checkCounter(uint index) public view {
        var (counter, error) = getCounter(index);
        if (error) {
            // ...
        } else {
            // ...
        }
    }
}
</pre></div>

</details><details class="faq"><summary>部署的合约中是否包含评论？他们是否增加了部署用气？</summary><p>不，编译过程中删除了不需要执行的所有内容。
其中包括评论，变量名称和类型名称。</p></details><details class="faq"><summary>如果您将ether与函数调用一起发送给合约，会发生什么情况？</summary><p>它会被添加到合同的总余额中，就像您在创建合同时发送以太币一样。
您只能将ether发送给具有<code>payable</code>修饰符的函数，否则会引发异常。</p></details><details class="faq"><summary>是否有可能获得执行合约到合约的交易的tx收据？</summary><p>不，从一个合约到另一个合约的函数调用不会创建自己的事务，您必须查看整个事务。
这也是为什么几个资源管理器不能正确显示Ether在合同之间发送的原因。</p></details><details class="faq"><summary>什么是“内存”关键字？,它有什么作用？</summary><p>以太坊虚拟机有三个可存储物品的区域。</p><p>首先是“存储”，即所有合同状态变量所在的位置。
每个合同都有自己的存储空间，它在函数调用之间是持久的，并且使用起来相当昂贵。</p><p>第二个是“记忆”，这是用来保存临时值。
它在（外部）函数调用之间被擦除，使用起来更便宜。</p><p>第三个是堆栈，用来存放小的局部变量。
它几乎可以自由使用，但只能保存有限的数值。</p><p>对于几乎所有的类型，您无法指定它们应存储的位置，因为每次使用它们时都会被复制。</p><p>所谓的存储位置很重要的类型是结构和数组。
如果你,在函数调用中传递这些变量，如果它们可以保留在内存中或保留在存储中，则不会复制它们的数据。
这意味着您可以在被调用的函数中修改其内容，并且这些修改仍将在调用者中可见。</p><p>存储位置的默认值取决于它所涉及的变量类型：</p><ul><li>状态变量始终处于存储状态</li><li>函数参数默认在内存中</li><li>默认情况下，结构，数组或映射类型引用存储的局部变量</li><li>值类型的局部变量（即既不是数组也不是结构也不映射）存储在堆栈中</li></ul><p>示例:</p><div class="codehilite"><pre><span></span>pragma solidity ^0.4.0;

contract C {
    uint[] data1;
    uint[] data2;

    function appendOne[4] public {
        append(data1);
    }

    function appendTwo[4] public {
        append(data2);
    }

    function append(uint[] storage d) internal {
        d.push(1);
    }
}
</pre></div>

<p>函数append可以在<code>data1</code>和<code>data2</code>上工作，并且它的修改将永久存储。
如果删除<code>storage</code>关键字，则缺省情况是将<code>memory</code>用于函数参数。
如果删除<code>storage</code>关键字，则缺省情况是将<code>memory</code>用于函数参数。
对这个独立副本的修改不会带回<code>data1</code>或<code>data2</code>。</p><p>一个常见的错误是声明一个局部变量，并假定它将在内存中创建，尽管它将在存储中创建：</p><div class="codehilite"><pre><span></span>/// THIS CONTRACT CONTAINS AN ERROR

pragma solidity ^0.4.0;

contract C {
    uint someVariable;
    uint[] data;

    function f[4] public {
        uint[] x;
        x.push(2);
        data = x;
    }
}
</pre></div>

<p>局部变量<code>x</code>的类型是<code>uint [] storage</code>，但由于存储不是动态分配的，因此它必须从状态变量中分配，然后才能使用。
因此，不会为<code>x</code>分配存储空间，但它只能作为存储中预先存在的变量的别名。</p><p>会发生什么是编译器将<code>x</code>解释为存储指针，并且会默认指向存储槽'0<code>。
这具有“someVariable”（位于存储槽“0”处）由</code>x.push（2）`修改的效果。</p><p>正确的做法如下：</p><div class="codehilite"><pre><span></span>pragma solidity ^0.4.0;

contract C {
    uint someVariable;
    uint[] data;

    function f[4] public {
        uint[] x = data;
        x.push(2);
    }
}
</pre></div>

</details><h2 id="_3">高级问题<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<details class="faq"><summary>你如何在合约中得到一个随机数字？ ,（实施自我回报赌博合约。）</summary><p>获得正确的随机性通常是加密项目中的关键部分，大多数失败都是由不好的随机数生成器造成的。</p><p>如果你不希望它是安全的，你可以建立类似于<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/35_coin_flipper.sol">硬币鳍状肢</a>的东西，但是另外一种情况是使用一种提供随机性的合同，如<a href="https://github.com/randao/randao">RANDAO</a>。</p></details><details class="faq"><summary>从另一个合同的非常量函数中获取返回值</summary><p>关键在于呼叫合同需要知道它打算调用的功能。
查看<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/45_ping.sol">ping.sol</a>和<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/45_pong.sol">pong.sol</a>.</p></details><details class="faq"><summary>在第一次开采时获得合约来做某件事</summary><p>使用构造函数。当合同首次开采时，其内的任何内容都将被执行。</p><p>查看<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/50_replicator.sol">replicator.sol</a>.</p></details><details class="faq"><summary>你如何创建2维数组？</summary><p>查看<a href="https://github.com/fivedogit/solidity-baby-steps/blob/master/contracts/55_2D_array.sol">2D_array.sol</a>.</p><p>请注意，在撰写本文时，填写10x10平方英尺的'uint8<code>+合同创建需要超过80万美元的天然气。
17x17采取</code>2,000,000`气体。
限制在314万......好吧，你现在可以创造的东西很低。</p><p>请注意，只是“创建”阵列是免费的，成本在填补它。</p><p>注2：优化存储访问可以显着降低天然气成本，因为32<code>uint8</code>值可以存储在一个插槽中。
问题在于，这些优化目前不能跨循环工作，并且在边界检查时也存在问题。
不过，您未来可能会获得更好的结果。</p></details><details class="faq"><summary>复制“struct”时，struct`映射会发生什么？</summary><p>这是一个非常有趣的问题。
假设我们有一个如此设置的合同字段：</p><div class="codehilite"><pre><span></span><span class="nx">struct</span> <span class="nx">User</span> <span class="p">{</span>
    <span class="nx">mapping</span><span class="p">(</span><span class="kt">string</span> <span class="o">=&gt;</span> <span class="kt">string</span><span class="p">)</span> <span class="nx">comments</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">somefunction</span> <span class="kr">public</span> <span class="p">{</span>
   <span class="nx">User</span> <span class="nx">user1</span><span class="p">;</span>
   <span class="nx">user1</span><span class="p">.</span><span class="nx">comments</span><span class="p">[</span><span class="s2">&quot;Hello&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;World&quot;</span><span class="p">;</span>
   <span class="nx">User</span> <span class="nx">user2</span> <span class="o">=</span> <span class="nx">user1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>In this case, the mapping of the struct being copied over into the userList is ignored as there is no "list of mapped keys".
Therefore it is not possible to find out which values should be copied over.</p></details><details class="faq"><summary>如何初始化只有特定数量的wei的合约？</summary><p>Currently the approach is a little ugly, but there is little that can be done to improve it.
In the case of a <code>contract A</code> calling a new instance of <code>contract B</code>, parentheses have to be used around <code>new B</code> because <code>B.value</code> would refer to a member of <code>B</code> called <code>value</code>.
You will need to make sure that you have both contracts aware of each other's presence and that <code>contract B</code> has a <code>payable</code> constructor.</p><p>In this 示例:</p><div class="codehilite"><pre><span></span>pragma solidity ^0.4.0;

contract B {
    function B[4] public payable {}
}

contract A {
    address child;

    function test[4] public {
        child = (new B).value(10)[4]; //construct a new B with 10 wei
    }
}
</pre></div>

</details><details class="faq"><summary>契约函数可以接受一个二维数组吗？</summary><p>This is not yet implemented for external calls and dynamic arrays -you can only use one level of dynamic arrays.</p></details><details class="faq"><summary><code>bytes32</code>和<code>string</code>之间的关系是什么？,为什么<code>bytes32 somevar =“stringliteral”;</code>起作用，保存的32字节十六进制值是什么意 思？</summary><p>The type <code>bytes32</code> can hold 32 (raw) bytes.
In the assignment <code>bytes32 samevar = "stringliteral";</code>, the string literal is interpreted in its raw byte form and if you inspect <code>somevar</code> and 查看a 32-byte hex value, this is just <code>"stringliteral"</code> in hex.</p><p>The type <code>bytes</code> is similar, only that it can change its length.</p><p>Finally, <code>string</code> is basically identical to <code>bytes</code> only that it is assumed to hold the UTF-8 encoding of a real string.
Since <code>string</code> stores the data in UTF-8 encoding it is quite expensive to compute the number of characters in the string (the encoding of some characters takes more than a single byte).
Because of that, <code>string s; s.length</code> is not yet supported and not even index access <code>s[2]</code>.
But if you want to access the low-level byte encoding of the string, you can use <code>bytes(s).length</code> and <code>bytes(s)[2]</code> which will result in the number of bytes in the UTF-8 encoding of the string (not the number of characters) and the second byte (not character) of the UTF-8 encoded string,respectively.</p></details><details class="faq"><summary>合约能否将一个数组（静态大小）或字符串或“字节”（动态大小）传递给另一个合约？</summary><p>Sure.
Take care that if you cross the memory / storage boundary, independent copies will be created:</p><div class="codehilite"><pre><span></span>pragma solidity ^0.4.16;

contract C {
    uint[20] x;

    function f[4] public {
        g(x);
        h(x);
    }

    function g(uint[20] y) internal pure {
        y[2] = 3;
    }

    function h(uint[20] storage y) internal {
        y[3] = 4;
    }
}
</pre></div>

<p>The call to <code>g(x)</code> will not have an effect on <code>x</code> because it needs to create an independent copy of the storage value in memory (the default storage location is memory).
On the other hand, <code>h(x)</code> successfully modifies <code>x</code> because only a reference and not a copy is passed.</p></details><details class="faq"><summary>有时候，当我试图用ex：arrayname.length = 7来改变一个数组的长度时，我得到一个编译器错误：Value必须是一个左值。,为什么？</summary><p>You can resize a dynamic array in storage (i.e. an array declared at the contract level) with <code>arrayname.length = &lt;some new length&gt;;</code>.
If you get the "lvalue" error, you are probably doing one of two things wrong.</p><ol><li>You might be trying to resize an array in "memory", or</li><li>You might be trying to resize a non-dynamic array.</li></ol><!-- -->
<div class="codehilite"><pre><span></span>int8[] memory memArr;        // Case 1
memArr.length++;             // illegal
int8[5] storageArr;          // Case 2
somearray.length++;          // legal
int8[5] storage storageArr2; // Explicit case 2
somearray2.length++;         // legal
</pre></div>

<p><strong>Important note:</strong> In Solidity, array dimensions are declared backwards from the way you might be used to declaring them in C or Java, but they are access as in C or Java.</p><p>For example, <code>int8[][5] somearray;</code> are 5 dynamic <code>int8</code> arrays.</p><p>The reason for this is that <code>T[5]</code> is always an array of 5 <code>T</code>'s, no matter whether <code>T</code> itself is an array or not (this is not the case in C or Java).</p></details><details class="faq"><summary>是否有可能从一个Solidity函数返回一个字符串数组（<code>string []</code>）？</summary><p>Not yet, as this requires two levels of dynamic arrays (<code>string</code> is a dynamic array itself).</p></details><details class="faq"><summary>如果你发出一个数组的调用，有可能检索整个数组？,或者你必须为此写一个辅助函数吗？</summary><p>The automatic <a href="https://github.com/comaeio/porosity">getter function<getter-functions></a> for a public state variable of array type only returns individual elements.
If you want to return the complete array, you have to manually write a function to do that.</p></details><details class="faq"><summary>如果一个帐户有存储值但没有代码，会发生什么情况？,例:</summary><p><a href="http://test.ether.camp/account/5f740b3a43fbb99724ce93a879805f4dc89178b5">http://test.ether.camp/account/5f740b3a43fbb99724ce93a879805f4dc89178b5</a></p><p>The last thing a constructor does is returning the code of the contract.
The gas costs for this depend on the length of the code and it might be that the supplied gas is not enough.
This situation is the only one where an "out of gas" exception does not revert changes to the state,
i.e. in this case the initialisation of the state variables.</p><p><a href="https://github.com/ethereum/wiki/wiki/Subtleties">https://github.com/ethereum/wiki/wiki/Subtleties</a></p><p>After a successful CREATE operation's sub-execution, if the operation returns x, 5 * len(x) gas is subtracted from the remaining gas before the contract is created.
If the remaining gas is less than 5 * len(x), then no gas is subtracted, the code of the created contract becomes the empty string, but this is not treated as an exceptional condition - no reverts happen.</p></details><details class="faq"><summary>以下奇怪的检查在自定义令牌合约中做了什么？</summary><div class="codehilite"><pre><span></span>require((balanceOf[_to] + _value) &gt;= balanceOf[_to]);
</pre></div>

<p>Integers in Solidity (and most other machine-related programming languages) are restricted to a certain range.
For <code>uint256</code>, this is <code>0</code> up to <code>2**256 - 1</code>.
If the result of some operation on those numbers does not fit inside this range, it is truncated.
These truncations can have <a href="https://en.bitcoin.it/wiki/Value_overflow_incident">serious consequences</a>, so     code like the one above is necessary to avoid certain attacks.</p></details><details class="faq"><summary>更多问题？</summary><p>If you have more questions or your question is not answered here, please talk to us on <a href="https://gitter.im/ethereum/solidity">gitter</a> or file an  <a href="https://github.com/ethereum/solidity/issues">issue</a>.</p></details>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../contributing/" title="贡献" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                贡献
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            版权 &copy; 2018 -  wohugb.github.io
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="http://wohugb.github.io" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/wohugb" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/wohugb" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/wohugb" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.6cdc17f0.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              <script src="../assets/javascripts/lunr/lunr.zh.js"></script>
            
          
          
        
      
      <script>app.initialize({version:"0.17.2",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>