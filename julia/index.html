



<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Solidity中文文档">
      
      
      
        <meta name="author" content="Nosy">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="zh">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.2.5">
    
    
      
        <title>JULIA - Solidity文档</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.bcabdff3.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.792431c1.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    
      <body data-md-color-primary="indigo" data-md-color-accent="indigo">
    
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Solidity文档" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Solidity文档
              </span>
              <span class="md-header-nav__topic">
                JULIA
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/wohugb/solidity-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/solidty-docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="简介" class="md-tabs__link md-tabs__link--active">
        简介
      </a>
    
  </li>

      
        
      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../solidity-in-depth/" title="深入" class="md-tabs__link">
          深入
        </a>
      
    </li>
  

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Solidity文档
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/wohugb/solidity-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/solidty-docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="简介" class="md-nav__link">
      简介
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../introduction-to-smart-contracts/" title="智能合约" class="md-nav__link">
      智能合约
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../installing-solidity/" title="安装编译器" class="md-nav__link">
      安装编译器
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../solidity-by-example/" title="举例" class="md-nav__link">
      举例
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      深入
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        深入
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../solidity-in-depth/" title="概述" class="md-nav__link">
      概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../layout-of-source-files/" title="源文件布局" class="md-nav__link">
      源文件布局
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../structure-of-a-contract/" title="合约结构" class="md-nav__link">
      合约结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../types/" title="类型" class="md-nav__link">
      类型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../units-and-global-variables/" title="单位和全局可用变量" class="md-nav__link">
      单位和全局可用变量
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../control-structures/" title="表达式和控制结构" class="md-nav__link">
      表达式和控制结构
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../contracts/" title="合约" class="md-nav__link">
      合约
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../assembly/" title="汇编" class="md-nav__link">
      汇编
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../miscellaneous/" title="杂项" class="md-nav__link">
      杂项
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../security-considerations/" title="安全考虑" class="md-nav__link">
      安全考虑
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../using-the-compiler/" title="使用编译器" class="md-nav__link">
      使用编译器
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contracts/" title="合约元数据" class="md-nav__link">
      合约元数据
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../abi-spec/" title="接口规范" class="md-nav__link">
      接口规范
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        JULIA
      </label>
    
    <a href="./" title="JULIA" class="md-nav__link md-nav__link--active">
      JULIA
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#julia" title="JULIA规格" class="md-nav__link">
    JULIA规格
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" title="对语法的限制" class="md-nav__link">
    对语法的限制
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" title="范围规则" class="md-nav__link">
    范围规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="形式规范" class="md-nav__link">
    形式规范
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" title="类型转换函数" class="md-nav__link">
    类型转换函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" title="低级函数" class="md-nav__link">
    低级函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" title="后端" class="md-nav__link">
    后端
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evm" title="后端: EVM" class="md-nav__link">
    后端: EVM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evm-15" title="后端: "EVM 1.5"" class="md-nav__link">
    后端: "EVM 1.5"
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ewasm" title="后端:eWASM" class="md-nav__link">
    后端:eWASM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#julia_1" title="JULIA对象的规范" class="md-nav__link">
    JULIA对象的规范
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../style-guide/" title="样式指南" class="md-nav__link">
      样式指南
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../common-patterns/" title="常见模式" class="md-nav__link">
      常见模式
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../bugs/" title="错误列表" class="md-nav__link">
      错误列表
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contributing/" title="贡献" class="md-nav__link">
      贡献
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../frequently-asked-questions/" title="常见问题" class="md-nav__link">
      常见问题
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#julia" title="JULIA规格" class="md-nav__link">
    JULIA规格
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" title="对语法的限制" class="md-nav__link">
    对语法的限制
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" title="范围规则" class="md-nav__link">
    范围规则
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" title="形式规范" class="md-nav__link">
    形式规范
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" title="类型转换函数" class="md-nav__link">
    类型转换函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" title="低级函数" class="md-nav__link">
    低级函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" title="后端" class="md-nav__link">
    后端
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evm" title="后端: EVM" class="md-nav__link">
    后端: EVM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evm-15" title="后端: "EVM 1.5"" class="md-nav__link">
    后端: "EVM 1.5"
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ewasm" title="后端:eWASM" class="md-nav__link">
    后端:eWASM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#julia_1" title="JULIA对象的规范" class="md-nav__link">
    JULIA对象的规范
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="joyfully-universal-language-for-inline-assembly">(内联)大会快乐的通用语言(Joyfully Universal Language for (Inline) Assembly)<a class="headerlink" href="#joyfully-universal-language-for-inline-assembly" title="Permanent link">&para;</a></h1>
<p>JULIA是一种可以编译到各种不同后端的中间语言(EVM 1.0,EVM 1.5和eWASM计划)。
正因为如此,它被设计成为所有三种平台的可用共同标准。
它已经可以用于Solidity内部的<code>内联汇编</code>,并且未来版本的Solidity编译器甚至将JULIA用作中间语言。
为JULIA构建高级优化器阶段也应该很容易。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>请注意,用于<code>内联汇编</code>的风格不具有类型(所有内容都是<code>u256</code>),并且内置函数与EVM操作码相同。
有关详细信息,请参阅内联汇编文档。</p>
</div>
<p>JULIA的核心组件是函数,块,变量,文本,for循环,if语句,switch语句,表达式和变量赋值。</p>
<p>JULIA是键入的,变量和文字都必须用后缀表示法指定类型。
支持的类型是<code>bool</code>,<code>u8</code>,<code>s8</code>,<code>u32</code>,<code>s32</code>,<code>u64</code>,<code>s64</code>,<code>u128</code>,<code>s128</code>,<code>u256</code>和<code>s256</code>。</p>
<p>JULIA本身甚至不提供运营商。
如果EVM是针对性的,则操作码将作为内置函数提供,但如果后端更改,则可以重新实现它们。
有关强制性内置函数的列表,请参阅下面的部分。</p>
<p>以下示例程序假定EVM操作码<code>mul</code>,<code>div</code>和<code>mod</code>可以本地或作为函数使用并计算指数运算。</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="k">function</span> <span class="n">power</span><span class="p">(</span><span class="n">base</span><span class="o">:</span><span class="n">u256</span><span class="p">,</span> <span class="n">exponent</span><span class="o">:</span><span class="n">u256</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">result</span><span class="o">:</span><span class="n">u256</span>
    <span class="p">{</span>
        <span class="n">switch</span> <span class="n">exponent</span>
        <span class="n">case</span> <span class="mi">0</span><span class="o">:</span><span class="n">u256</span> <span class="p">{</span> <span class="n">result</span> <span class="o">:=</span> <span class="mi">1</span><span class="o">:</span><span class="n">u256</span> <span class="p">}</span>
        <span class="n">case</span> <span class="mi">1</span><span class="o">:</span><span class="n">u256</span> <span class="p">{</span> <span class="n">result</span> <span class="o">:=</span> <span class="n">base</span> <span class="p">}</span>
        <span class="n">default</span><span class="o">:</span>
        <span class="p">{</span>
        <span class="n">result</span> <span class="o">:=</span> <span class="n">power</span><span class="p">(</span><span class="n">mul</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">base</span><span class="p">),</span> <span class="n">div</span><span class="p">(</span><span class="n">exponent</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="n">u256</span><span class="p">))</span>
        <span class="n">switch</span> <span class="n">mod</span><span class="p">(</span><span class="n">exponent</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="n">u256</span><span class="p">)</span>
        <span class="n">case</span> <span class="mi">1</span><span class="o">:</span><span class="n">u256</span> <span class="p">{</span> <span class="n">result</span> <span class="o">:=</span> <span class="n">mul</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>也可以使用for循环而不是递归来实现相同的函数。在这里,我们需要EVM操作码<code>lt</code>(小于)和<code>add</code>可用。</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="k">function</span> <span class="n">power</span><span class="p">(</span><span class="n">base</span><span class="o">:</span><span class="n">u256</span><span class="p">,</span> <span class="n">exponent</span><span class="o">:</span><span class="n">u256</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">result</span><span class="o">:</span><span class="n">u256</span>
    <span class="p">{</span>
        <span class="n">result</span> <span class="o">:=</span> <span class="mi">1</span><span class="o">:</span><span class="n">u256</span>
        <span class="k">for</span> <span class="p">{</span> <span class="k">let</span> <span class="n">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="o">:</span><span class="n">u256</span> <span class="p">}</span> <span class="n">lt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">exponent</span><span class="p">)</span> <span class="p">{</span> <span class="n">i</span> <span class="o">:=</span> <span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="n">u256</span><span class="p">)</span> <span class="p">}</span>
        <span class="p">{</span>
        <span class="n">result</span> <span class="o">:=</span> <span class="n">mul</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h2 id="julia">JULIA规格<a class="headerlink" href="#julia" title="Permanent link">&para;</a></h2>
<p>本章介绍JULIA代码。JULIA代码通常放置在JULIA对象中,将在下一章中介绍。</p>
<p>语法:</p>
<div class="codehilite"><pre><span></span>    <span class="n">Block</span> <span class="o">=</span> <span class="sc">&#39;{&#39;</span> <span class="n">Statement</span><span class="o">*</span> <span class="sc">&#39;}&#39;</span>
    <span class="n">Statement</span> <span class="o">=</span> <span class="n">Block</span> <span class="o">|</span> <span class="n">FunctionDefinition</span> <span class="o">|</span> <span class="n">VariableDeclaration</span> <span class="o">|</span>  <span class="n">Assignment</span> <span class="o">|</span> <span class="n">Expression</span> <span class="o">|</span> <span class="n">Switch</span> <span class="o">|</span> <span class="n">ForLoop</span> <span class="o">|</span> <span class="n">BreakContinue</span>
    <span class="n">FunctionDefinition</span> <span class="o">=</span> <span class="err">&#39;</span><span class="k">function</span><span class="o">&#39;</span> <span class="n">Identifier</span> <span class="sc">&#39;(&#39;</span> <span class="n">TypedIdentifierList</span><span class="o">?</span> <span class="sc">&#39;)&#39;</span><span class="p">(</span> <span class="err">&#39;</span><span class="o">-&gt;</span><span class="err">&#39;</span> <span class="n">TypedIdentifierList</span> <span class="p">)</span><span class="o">?</span> <span class="n">Block</span>
    <span class="n">VariableDeclaration</span> <span class="o">=</span> <span class="err">&#39;</span><span class="k">let</span><span class="o">&#39;</span> <span class="n">TypedIdentifierList</span> <span class="p">(</span> <span class="err">&#39;</span><span class="o">:=</span><span class="err">&#39;</span> <span class="n">Expression</span> <span class="p">)</span><span class="o">?</span>
    <span class="n">Assignment</span> <span class="o">=</span> <span class="n">IdentifierList</span> <span class="err">&#39;</span><span class="o">:=</span><span class="err">&#39;</span> <span class="n">Expression</span>
    <span class="n">Expression</span> <span class="o">=</span> <span class="n">FunctionCall</span> <span class="o">|</span> <span class="n">Identifier</span> <span class="o">|</span> <span class="n">Literal</span>
    <span class="n">If</span> <span class="o">=</span> <span class="err">&#39;</span><span class="k">if</span><span class="o">&#39;</span> <span class="n">Expression</span> <span class="n">Block</span>
    <span class="n">Switch</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">switch</span><span class="o">&#39;</span> <span class="n">Expression</span> <span class="n">Case</span><span class="o">*</span> <span class="p">(</span> <span class="err">&#39;</span><span class="n">default</span><span class="o">&#39;</span> <span class="n">Block</span> <span class="p">)</span><span class="o">?</span>
    <span class="n">Case</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">case</span><span class="o">&#39;</span> <span class="n">Literal</span> <span class="n">Block</span>
    <span class="n">ForLoop</span> <span class="o">=</span> <span class="err">&#39;</span><span class="k">for</span><span class="o">&#39;</span> <span class="n">Block</span> <span class="n">Expression</span> <span class="n">Block</span> <span class="n">Block</span>
    <span class="n">BreakContinue</span> <span class="o">=</span> <span class="err">&#39;</span><span class="k">break</span><span class="o">&#39;</span> <span class="o">|</span> <span class="err">&#39;</span><span class="k">continue</span><span class="o">&#39;</span>
    <span class="n">FunctionCall</span> <span class="o">=</span> <span class="n">Identifier</span> <span class="sc">&#39;(&#39;</span> <span class="p">(</span> <span class="n">Expression</span> <span class="p">(</span> <span class="sc">&#39;,&#39;</span> <span class="n">Expression</span> <span class="p">)</span><span class="o">*</span> <span class="p">)</span><span class="o">?</span> <span class="sc">&#39;)&#39;</span>
    <span class="n">Identifier</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="n">zA</span><span class="o">-</span><span class="n">Z_</span><span class="o">$</span><span class="p">]</span> <span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="n">zA</span><span class="o">-</span><span class="n">Z_0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span>
    <span class="n">IdentifierList</span> <span class="o">=</span> <span class="n">Identifier</span> <span class="p">(</span> <span class="sc">&#39;,&#39;</span> <span class="n">Identifier</span><span class="p">)</span><span class="o">*</span>
    <span class="kt">TypeName</span> <span class="o">=</span> <span class="n">Identifier</span> <span class="o">|</span> <span class="n">BuiltinTypeName</span>
    <span class="n">BuiltinTypeName</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">bool</span><span class="o">&#39;</span> <span class="o">|</span> <span class="p">[</span><span class="n">us</span><span class="p">]</span> <span class="p">(</span> <span class="sc">&#39;8&#39;</span> <span class="o">|</span> <span class="err">&#39;</span><span class="mi">32</span><span class="o">&#39;</span> <span class="o">|</span> <span class="err">&#39;</span><span class="mi">64</span><span class="o">&#39;</span> <span class="o">|</span> <span class="err">&#39;</span><span class="mi">128</span><span class="o">&#39;</span> <span class="o">|</span> <span class="err">&#39;</span><span class="mi">256</span><span class="o">&#39;</span> <span class="p">)</span>
    <span class="n">TypedIdentifierList</span> <span class="o">=</span> <span class="n">Identifier</span> <span class="sc">&#39;:&#39;</span> <span class="kt">TypeName</span> <span class="p">(</span> <span class="sc">&#39;,&#39;</span> <span class="n">Identifier</span> <span class="sc">&#39;:&#39;</span> <span class="kt">TypeName</span> <span class="p">)</span><span class="o">*</span>
    <span class="n">Literal</span> <span class="o">=</span> <span class="p">(</span><span class="n">NumberLiteral</span> <span class="o">|</span> <span class="n">StringLiteral</span> <span class="o">|</span> <span class="n">HexLiteral</span> <span class="o">|</span> <span class="n">TrueLiteral</span> <span class="o">|</span> <span class="n">FalseLiteral</span><span class="p">)</span> <span class="sc">&#39;:&#39;</span> <span class="kt">TypeName</span>
    <span class="n">NumberLiteral</span> <span class="o">=</span> <span class="n">HexNumber</span> <span class="o">|</span> <span class="n">DecimalNumber</span>
    <span class="n">HexLiteral</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">hex</span><span class="o">&#39;</span> <span class="p">(</span><span class="sc">&#39;&quot;&#39;</span> <span class="p">([</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="n">a</span><span class="o">-</span><span class="n">fA</span><span class="o">-</span><span class="n">F</span><span class="p">]{</span><span class="mi">2</span><span class="p">})</span><span class="o">*</span> <span class="sc">&#39;&quot;&#39;</span> <span class="o">|</span> <span class="err">&#39;&#39;&#39;</span> <span class="p">([</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="n">a</span><span class="o">-</span><span class="n">fA</span><span class="o">-</span><span class="n">F</span><span class="p">]{</span><span class="mi">2</span><span class="p">})</span><span class="o">*</span> <span class="err">&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">StringLiteral</span> <span class="o">=</span> <span class="sc">&#39;&quot;&#39;</span> <span class="p">([</span><span class="o">^</span><span class="s">&quot;rn] | &#39;&#39; .)* &#39;&quot;</span><span class="err">&#39;</span>
    <span class="n">TrueLiteral</span> <span class="o">=</span> <span class="err">&#39;</span><span class="kc">true</span><span class="o">&#39;</span>
    <span class="n">FalseLiteral</span> <span class="o">=</span> <span class="err">&#39;</span><span class="kc">false</span><span class="o">&#39;</span>
    <span class="n">HexNumber</span> <span class="o">=</span> <span class="err">&#39;</span><span class="mi">0</span><span class="n">x</span><span class="o">&#39;</span> <span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="n">a</span><span class="o">-</span><span class="n">fA</span><span class="o">-</span><span class="n">F</span><span class="p">]</span><span class="o">+</span>
    <span class="n">DecimalNumber</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span>
</pre></div>

<h3 id="_1">对语法的限制<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>交换机必须至少有一个案例(包括默认案例)。
如果表达式的所有可能值都被覆盖了,那么就不应该允许使用默认情况(例如,带<code>bool</code>表达式的开关并且同时具有true和false情况不应允许默认情况)。</p>
<p>每个表达式都计算为零个或多个值。
标识符和文字只计算一个值,函数调用计算的值等于所调用函数的返回值数。</p>
<p>在变量声明和赋值中,右侧表达式(如果存在)必须计算出与左侧变量数量相等的许多值。
这是唯一允许评估多个值的表达式。</p>
<p>也是语句的表达式(即在块级别)必须评估为零值。</p>
<p>在所有其他情况下,表达式必须评估为恰好一个值。</p>
<p><code>continue</code>和<code>break</code>语句只能在循环体内使用,并且必须与循环具有相同的功能(或者两者必须位于顶层)。
for-loop的条件部分必须评估到一个值。</p>
<p>文字不能大于他们的类型。
定义的最大类型是256位宽。</p>
<h3 id="_2">范围规则<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>JULIA中的范围与块(除了函数和for循环,如下所述)以及所有声明(<code>FunctionDefinition</code>,<code>VariableDeclaration</code>)引入新的标识符到这些范围。</p>
<p>标识符在其定义的块中(包括所有子节点和子块)中都可见。
作为例外,for循环(第一个块)的<code>init</code>部分中定义的标识符在for循环的所有其他部分中都可见(但不在循环外部)。
在for循环的其他部分声明的标识符遵守常规的合成范围规则。
函数的参数和返回参数在函数体中可见,并且它们的名称不能重叠。</p>
<p>变量只能在声明后引用。
特别是变量不能在自己的变量声明的右边引用。
函数可以在声明之前被引用(如果它们是可见的)。</p>
<p>阴影是不允许的,即不能在另一个同名的标识符可见的位置声明一个标识符,即使它不可访问。</p>
<p>在函数内部,不可能访问在该函数之外声明的变量。</p>
<h3 id="_3">形式规范<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>我们通过在AST的各个节点上提供重载评估函数E来正式指定JULIA。
任何函数都可能有副作用,所以E需要两个状态对象和AST节点,并返回两个新的状态对象和可变数量的其他值。
这两个状态对象是全局状态对象(在EVM的上下文中是区块链的内存,存储和状态)和本地状态对象(局部变量的状态,即EVM中堆栈的一部分) ,。
如果AST节点是一个语句,E将返回两个状态对象和一个<code>模式</code>,用于<code>break</code>和<code>continue</code>语句。
如果AST节点是表达式,则E返回两个状态对象,并返回与表达式计算结果相同的值。</p>
<p>对于这个高层次的描述,全球国家的确切性质并没有说明。
本地状态<code>L</code>是标识符<code>i</code>到值<code>v</code>的映射,表示为<code>L [i] = v</code>。</p>
<p>对于标识符<code>v</code>,让<code>$ v</code>为标识符的名称。</p>
<p>我们将使用AST节点的解构符号。</p>
<div class="codehilite"><pre><span></span><span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">&lt;</span><span class="p">{</span><span class="n">St1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">Stn</span><span class="p">}</span><span class="o">&gt;:</span> <span class="n">Block</span><span class="p">)</span> <span class="o">=</span>
 <span class="k">let</span> <span class="n">G1</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">St1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">Stn</span><span class="p">)</span>
 <span class="k">let</span> <span class="n">L2</span> <span class="n">be</span> <span class="n">a</span> <span class="n">restriction</span> <span class="n">of</span> <span class="n">L1</span> <span class="n">to</span> <span class="n">the</span> <span class="n">identifiers</span> <span class="n">of</span> <span class="n">L</span>
 <span class="n">G1</span><span class="p">,</span> <span class="n">L2</span><span class="p">,</span> <span class="n">mode</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">St1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">Stn</span><span class="o">:</span> <span class="n">Statement</span><span class="p">)</span> <span class="o">=</span>
 <span class="k">if</span> <span class="n">n</span> <span class="n">is</span> <span class="n">zero</span><span class="o">:</span>
  <span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">regular</span>
 <span class="k">else</span><span class="o">:</span>
  <span class="k">let</span> <span class="n">G1</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">St1</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">mode</span> <span class="n">is</span> <span class="n">regular</span> <span class="n">then</span>
 <span class="n">E</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">St2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">Stn</span><span class="p">)</span>
  <span class="n">otherwise</span>
 <span class="n">G1</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">mode</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">FunctionDefinition</span><span class="p">)</span> <span class="o">=</span>
 <span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">regular</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">let</span> <span class="n">var1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">varn</span> <span class="o">:=</span> <span class="n">rhs</span><span class="o">&gt;:</span> <span class="n">VariableDeclaration</span><span class="p">)</span> <span class="o">=</span>
 <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">var1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">varn</span> <span class="o">:=</span> <span class="n">rhs</span><span class="o">&gt;:</span> <span class="n">Assignment</span><span class="p">)</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">let</span> <span class="n">var1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">varn</span><span class="o">&gt;:</span> <span class="n">VariableDeclaration</span><span class="p">)</span> <span class="o">=</span>
 <span class="k">let</span> <span class="n">L1</span> <span class="n">be</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">L</span> <span class="n">where</span> <span class="n">L1</span><span class="p">[</span><span class="o">$</span><span class="n">vari</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">n</span>
 <span class="n">G</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">regular</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">var1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">varn</span> <span class="o">:=</span> <span class="n">rhs</span><span class="o">&gt;:</span> <span class="n">Assignment</span><span class="p">)</span> <span class="o">=</span>
 <span class="k">let</span> <span class="n">G1</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">vn</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
 <span class="k">let</span> <span class="n">L2</span> <span class="n">be</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">L1</span> <span class="n">where</span> <span class="n">L2</span><span class="p">[</span><span class="o">$</span><span class="n">vari</span><span class="p">]</span> <span class="o">=</span> <span class="n">vi</span> <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">n</span>
 <span class="n">G</span><span class="p">,</span> <span class="n">L2</span><span class="p">,</span> <span class="n">regular</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">for</span> <span class="p">{</span> <span class="n">i1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="kp">in</span> <span class="p">}</span> <span class="n">condition</span> <span class="n">post</span> <span class="n">body</span><span class="o">&gt;:</span> <span class="n">ForLoop</span><span class="p">)</span> <span class="o">=</span>
 <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="o">:</span>
  <span class="k">let</span> <span class="n">G1</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="kp">in</span><span class="p">)</span>
  <span class="o">//</span> <span class="n">mode</span> <span class="n">has</span> <span class="n">to</span> <span class="n">be</span> <span class="n">regular</span> <span class="n">due</span> <span class="n">to</span> <span class="n">the</span> <span class="n">syntactic</span> <span class="n">restrictions</span>
  <span class="k">let</span> <span class="n">G2</span><span class="p">,</span> <span class="n">L2</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="k">for</span> <span class="p">{}</span> <span class="n">condition</span> <span class="n">post</span> <span class="n">body</span><span class="p">)</span>
  <span class="o">//</span> <span class="n">mode</span> <span class="n">has</span> <span class="n">to</span> <span class="n">be</span> <span class="n">regular</span> <span class="n">due</span> <span class="n">to</span> <span class="n">the</span> <span class="n">syntactic</span> <span class="n">restrictions</span>
  <span class="k">let</span> <span class="n">L3</span> <span class="n">be</span> <span class="n">the</span> <span class="n">restriction</span> <span class="n">of</span> <span class="n">L2</span> <span class="n">to</span> <span class="n">only</span> <span class="n">variables</span> <span class="n">of</span> <span class="n">L</span>
  <span class="n">G2</span><span class="p">,</span> <span class="n">L3</span><span class="p">,</span> <span class="n">regular</span>
 <span class="k">else</span><span class="o">:</span>
  <span class="k">let</span> <span class="n">G1</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">condition</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">v</span> <span class="n">is</span> <span class="kc">false</span><span class="o">:</span>
 <span class="n">G1</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">regular</span>
  <span class="k">else</span><span class="o">:</span>
 <span class="k">let</span> <span class="n">G2</span><span class="p">,</span> <span class="n">L2</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
 <span class="k">if</span> <span class="n">mode</span> <span class="n">is</span> <span class="k">break</span><span class="o">:</span>
 <span class="n">G2</span><span class="p">,</span> <span class="n">L2</span><span class="p">,</span> <span class="n">regular</span>
 <span class="k">else</span><span class="o">:</span>
 <span class="n">G3</span><span class="p">,</span> <span class="n">L3</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G2</span><span class="p">,</span> <span class="n">L2</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span>
 <span class="n">E</span><span class="p">(</span><span class="n">G3</span><span class="p">,</span> <span class="n">L3</span><span class="p">,</span> <span class="k">for</span> <span class="p">{}</span> <span class="n">condition</span> <span class="n">post</span> <span class="n">body</span><span class="p">)</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="k">break</span><span class="o">:</span> <span class="n">BreakContinue</span><span class="p">)</span> <span class="o">=</span>
 <span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="k">break</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="k">continue</span><span class="o">:</span> <span class="n">BreakContinue</span><span class="p">)</span> <span class="o">=</span>
 <span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="k">continue</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">if</span> <span class="n">condition</span> <span class="n">body</span><span class="o">&gt;:</span> <span class="n">If</span><span class="p">)</span> <span class="o">=</span>
 <span class="k">let</span> <span class="n">G0</span><span class="p">,</span> <span class="n">L0</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">condition</span><span class="p">)</span>
 <span class="k">if</span> <span class="n">v</span> <span class="n">is</span> <span class="kc">true</span><span class="o">:</span>
  <span class="n">E</span><span class="p">(</span><span class="n">G0</span><span class="p">,</span> <span class="n">L0</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
 <span class="k">else</span><span class="o">:</span>
  <span class="n">G0</span><span class="p">,</span> <span class="n">L0</span><span class="p">,</span> <span class="n">regular</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">switch</span> <span class="n">condition</span> <span class="n">case</span> <span class="n">l1</span><span class="o">:</span><span class="n">t1</span> <span class="n">st1</span> <span class="o">...</span>
<span class="n">case</span> <span class="n">ln</span><span class="o">:</span><span class="n">tn</span> <span class="n">stn</span><span class="o">&gt;:</span> <span class="n">Switch</span><span class="p">)</span> <span class="o">=</span>
 <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">switch</span> <span class="n">condition</span> <span class="n">case</span> <span class="n">l1</span><span class="o">:</span><span class="n">t1</span> <span class="n">st1</span> <span class="o">...</span>
<span class="n">case</span> <span class="n">ln</span><span class="o">:</span><span class="n">tn</span> <span class="n">stn</span> <span class="n">default</span> <span class="p">{})</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">switch</span> <span class="n">condition</span> <span class="n">case</span> <span class="n">l1</span><span class="o">:</span><span class="n">t1</span> <span class="n">st1</span> <span class="o">...</span>
<span class="n">case</span> <span class="n">ln</span><span class="o">:</span><span class="n">tn</span> <span class="n">stn</span> <span class="n">default</span> <span class="n">st</span><span class="o">&#39;&gt;:</span> <span class="n">Switch</span><span class="p">)</span> <span class="o">=</span>
 <span class="k">let</span> <span class="n">G0</span><span class="p">,</span> <span class="n">L0</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">condition</span><span class="p">)</span>
 <span class="o">//</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">..</span>
<span class="n">n</span>
 <span class="o">//</span> <span class="n">Evaluate</span> <span class="n">literals</span><span class="p">,</span> <span class="n">context</span> <span class="n">doesn</span><span class="o">&#39;</span><span class="n">t</span> <span class="n">matter</span>
 <span class="k">let</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G0</span><span class="p">,</span> <span class="n">L0</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>
 <span class="o">...</span>
 <span class="k">let</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">vn</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G0</span><span class="p">,</span> <span class="n">L0</span><span class="p">,</span> <span class="n">ln</span><span class="p">)</span>
 <span class="k">if</span> <span class="n">there</span> <span class="n">exists</span> <span class="n">smallest</span> <span class="n">i</span> <span class="n">such</span> <span class="n">that</span> <span class="n">vi</span> <span class="o">=</span> <span class="n">v</span><span class="o">:</span>
  <span class="n">E</span><span class="p">(</span><span class="n">G0</span><span class="p">,</span> <span class="n">L0</span><span class="p">,</span> <span class="n">sti</span><span class="p">)</span>
 <span class="k">else</span><span class="o">:</span>
  <span class="n">E</span><span class="p">(</span><span class="n">G0</span><span class="p">,</span> <span class="n">L0</span><span class="p">,</span> <span class="n">st</span><span class="o">&#39;</span><span class="p">)</span>

<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;:</span> <span class="n">Identifier</span><span class="p">)</span> <span class="o">=</span>
 <span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="o">$</span><span class="n">name</span><span class="p">]</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">fname</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">argn</span><span class="p">)</span><span class="o">&gt;:</span> <span class="n">FunctionCall</span><span class="p">)</span> <span class="o">=</span>
 <span class="n">G1</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">vn</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">argn</span><span class="p">)</span>
 <span class="o">...</span>
 <span class="n">G</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">arg2</span><span class="p">)</span>
 <span class="n">Gn</span><span class="p">,</span> <span class="n">Ln</span><span class="p">,</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">arg1</span><span class="p">)</span>
 <span class="n">Let</span> <span class="o">&lt;</span><span class="k">function</span> <span class="n">fname</span> <span class="p">(</span><span class="n">param1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">paramn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ret1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">retm</span> <span class="n">block</span><span class="o">&gt;</span>
 <span class="n">be</span> <span class="n">the</span> <span class="k">function</span> <span class="n">of</span> <span class="n">name</span> <span class="o">$</span><span class="n">fname</span> <span class="n">visible</span> <span class="n">at</span> <span class="n">the</span> <span class="n">point</span> <span class="n">of</span> <span class="n">the</span> <span class="n">call</span><span class="o">.</span>
 <span class="n">Let</span> <span class="n">L</span><span class="o">&#39;</span> <span class="n">be</span> <span class="n">a</span> <span class="n">new</span> <span class="kd">local</span> <span class="n">state</span> <span class="n">such</span> <span class="n">that</span>
 <span class="n">L</span><span class="o">&#39;</span><span class="p">[</span><span class="o">$</span><span class="n">parami</span><span class="p">]</span> <span class="o">=</span> <span class="n">vi</span> <span class="n">and</span> <span class="n">L</span><span class="o">&#39;</span><span class="p">[</span><span class="o">$</span><span class="n">reti</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">all</span> <span class="n">i</span><span class="o">.</span>
 <span class="n">Let</span> <span class="n">G</span><span class="o">&#39;&#39;</span><span class="p">,</span> <span class="n">L</span><span class="o">&#39;&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">Gn</span><span class="p">,</span> <span class="n">L</span><span class="o">&#39;</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>
 <span class="n">G</span><span class="o">&#39;&#39;</span><span class="p">,</span> <span class="n">Ln</span><span class="p">,</span> <span class="n">L</span><span class="o">&#39;&#39;</span><span class="p">[</span><span class="o">$</span><span class="n">ret1</span><span class="p">],</span> <span class="o">...</span><span class="p">,</span> <span class="n">L</span><span class="o">&#39;&#39;</span><span class="p">[</span><span class="o">$</span><span class="n">retm</span><span class="p">]</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">l</span><span class="o">:</span> <span class="n">HexLiteral</span><span class="p">)</span> <span class="o">=</span> <span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">hexString</span><span class="p">(</span><span class="n">l</span><span class="p">),</span>
 <span class="n">where</span> <span class="n">hexString</span> <span class="n">decodes</span> <span class="n">l</span> <span class="n">from</span> <span class="n">hex</span> <span class="n">and</span> <span class="n">left</span><span class="o">-</span><span class="n">aligns</span> <span class="n">it</span> <span class="n">into</span> <span class="mi">32</span> <span class="n">bytes</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">l</span><span class="o">:</span> <span class="n">StringLiteral</span><span class="p">)</span> <span class="o">=</span> <span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">utf8EncodeLeftAligned</span><span class="p">(</span><span class="n">l</span><span class="p">),</span>
 <span class="n">where</span> <span class="n">utf8EncodeLeftAligned</span> <span class="n">performs</span> <span class="n">a</span> <span class="n">utf8</span> <span class="n">encoding</span> <span class="n">of</span> <span class="n">l</span>
 <span class="n">and</span> <span class="n">aligns</span> <span class="n">it</span> <span class="n">left</span> <span class="n">into</span> <span class="mi">32</span> <span class="n">bytes</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="o">:</span> <span class="n">HexNumber</span><span class="p">)</span> <span class="o">=</span> <span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">hex</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
 <span class="n">where</span> <span class="n">hex</span> <span class="n">is</span> <span class="n">the</span> <span class="n">hexadecimal</span> <span class="n">decoding</span> <span class="k">function</span>
<span class="n">E</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="o">:</span> <span class="n">DecimalNumber</span><span class="p">)</span> <span class="o">=</span> <span class="n">G</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">dec</span><span class="p">(</span><span class="n">n</span><span class="p">),</span>
 <span class="n">where</span> <span class="n">dec</span> <span class="n">is</span> <span class="n">the</span> <span class="n">decimal</span> <span class="n">decoding</span> <span class="k">function</span>
</pre></div>

<h3 id="_4">类型转换函数<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>JULIA不支持隐式类型转换,因此存在提供显式转换的函数。
在将较大类型转换为较短类型时,如果发生溢出,则可能会发生运行时异常。</p>
<p>下面的类型转换函数必须可用: - <code>u32tobool(x:u32) -&gt; y:bool</code> - <code>booltou32(x:bool) -&gt; y:u32</code> - <code>u32tou64(x:u32) -&gt; y:u64</code> - <code>u64tou32(x:u64) -&gt; y:u32</code> -  等(待定)</p>
<h3 id="_5">低级函数<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>以下功能必须可用:</p>
<table>
<thead>
<tr>
<th><em>算术</em></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>addu256(x:u256, y:u256) -&gt; z:u256</td>
<td>x + y</td>
</tr>
<tr>
<td>subu256(x:u256, y:u256) -&gt; z:u256</td>
<td>x - y</td>
</tr>
<tr>
<td>mulu256(x:u256, y:u256) -&gt; z:u256</td>
<td>x * y</td>
</tr>
<tr>
<td>divu256(x:u256, y:u256) -&gt; z:u256</td>
<td>x/y</td>
</tr>
<tr>
<td>divs256(x:s256, y:s256) -&gt; z:s256</td>
<td>x/y, 对于二进制补码中的有符号数</td>
</tr>
<tr>
<td>modu256(x:u256, y:u256) -&gt; z:u256</td>
<td>x % y</td>
</tr>
<tr>
<td>mods256(x:s256, y:s256) -&gt; z:s256</td>
<td>x % y, 对于二进制补码中的有符号数</td>
</tr>
<tr>
<td>signextendu256(i:u256, x:u256) -&gt; z:u256</td>
<td>符号从最低有效位(i * 8 + 7)位开始计数</td>
</tr>
<tr>
<td>expu256(x:u256, y:u256) -&gt; z:u256</td>
<td>x对y的力量</td>
</tr>
<tr>
<td>addmodu256(x:u256, y:u256, m:u256) -&gt; z:u256</td>
<td>(x + y)％m与任意精确算术</td>
</tr>
<tr>
<td>mulmodu256(x:u256, y:u256, m:u256) -&gt; z:u256</td>
<td>(x * y)％m与任意精确算术</td>
</tr>
<tr>
<td>ltu256(x:u256, y:u256) -&gt; z:bool</td>
<td>1如果x &lt;y,则为0</td>
</tr>
<tr>
<td>gtu256(x:u256, y:u256) -&gt; z:bool</td>
<td>1如果x&gt; y,否则为0</td>
</tr>
<tr>
<td>sltu256(x:s256, y:s256) -&gt; z:bool</td>
<td>如果x &lt;y,则为1,否则为0,用于补码中的有符号数</td>
</tr>
<tr>
<td>sgtu256(x:s256, y:s256) -&gt; z:bool</td>
<td>1如果x&gt; y,则为0,否则为2的补码中的有符号数</td>
</tr>
<tr>
<td>equ256(x:u256, y:u256) -&gt; z:bool</td>
<td>1如果x == y,否则为0</td>
</tr>
<tr>
<td>notu256(x:u256) -&gt; z:u256</td>
<td>~x,x的每一位都是否定的</td>
</tr>
<tr>
<td>andu256(x:u256, y:u256) -&gt; z:u256</td>
<td>按位和x和y</td>
</tr>
<tr>
<td>oru256(x:u256, y:u256) -&gt; z:u256</td>
<td>按位和x和y</td>
</tr>
<tr>
<td>xoru256(x:u256, y:u256) -&gt; z:u256</td>
<td>x和y的按位异或</td>
</tr>
<tr>
<td>shlu256(x:u256, y:u256) -&gt; z:u256</td>
<td>x乘以y的逻辑左移</td>
</tr>
<tr>
<td>shru256(x:u256, y:u256) -&gt; z:u256</td>
<td>y的逻辑右移</td>
</tr>
<tr>
<td>saru256(x:u256, y:u256) -&gt; z:u256</td>
<td>x乘以y的算术右移</td>
</tr>
<tr>
<td>byte(n:u256, x:u256) -&gt; v:u256</td>
<td>x的第n个字节,其中最高有效字节是第0个字节不能用and256(shr256(n,x),0xff替代),并让它由EVM后端进行优化？</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><em>内存和存储</em></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>mload(p:u256) -&gt; v:u256</td>
<td>mem[p..(p+32))</td>
</tr>
<tr>
<td>mstore(p:u256, v:u256)</td>
<td>mem[p..(p+32)) := v</td>
</tr>
<tr>
<td>mstore8(p:u256, v:u256)</td>
<td>mem[p] := v &amp; 0xff - 只修改一个字节</td>
</tr>
<tr>
<td>sload(p:u256) -&gt; v:u256</td>
<td>storage[p]</td>
</tr>
<tr>
<td>sstore(p:u256, v:u256)</td>
<td>storage[p] := v</td>
</tr>
<tr>
<td>msize() -&gt; size:u256</td>
<td>内存大小,即最大访问内存索引,尽管是由于:由于内存扩展功能(由字扩展),这将总是32字节的倍数</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><em>执行控制</em></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>create(v:u256, p:u256, s:u256)</td>
<td>用代码mem [p ..(p + s))创建新的合同并发送v wei并返回新的地址</td>
</tr>
<tr>
<td>call(g:u256, a:u256, v:u256, in:u256,</td>
<td>在地址a处输入合同,输入mem [in ..(in + insize))insize:u256,out:u256,提供g gas和v wei,输出区域超大:u256)mem [out ..(out + oversize)),错误时返回0(例如,气体不足) - &gt; r:u256和1成功</td>
</tr>
<tr>
<td>callcode(g:u256, a:u256, v:u256, in:u256,</td>
<td>与<code>call</code>完全相同,但只能使用insize:u256,out:u256,</td>
</tr>
<tr>
<td>delegatecall(g:u256, a:u256, in:u256,</td>
<td>与<code>callcode</code>相同,insize:u256,out:u256,</td>
</tr>
<tr>
<td>stop()</td>
<td>停止执行,与返回相同(0,0)也许它会有意义的退出,因为它等于return(0,0)。它可以是EVM后端的优化。</td>
</tr>
<tr>
<td>abort()</td>
<td>中止(相当于EVM上的无效指令)</td>
</tr>
<tr>
<td>return(p:u256, s:u256)</td>
<td>结束执行,返回数据mem [p ..(p + s))</td>
</tr>
<tr>
<td>revert(p:u256, s:u256)</td>
<td>结束执行,恢复状态更改,返回数据mem [p ..(p + s))</td>
</tr>
<tr>
<td>selfdestruct(a:u256)</td>
<td>终止执行,摧毁当前合同并将资金发送给</td>
</tr>
<tr>
<td>log0(p:u256, s:u256)</td>
<td>没有主题和数据记录[p ..(p + s))</td>
</tr>
<tr>
<td>log1(p:u256, s:u256, t1:u256)</td>
<td>记录主题t1和数据mem [p ..(p + s))</td>
</tr>
<tr>
<td>log2(p:u256, s:u256, t1:u256, t2:u256)</td>
<td>记录主题t1,t2和数据mem [p ..(p + s))</td>
</tr>
<tr>
<td>log3(p:u256, s:u256, t1:u256, t2:u256,</td>
<td>记录主题t,t2,t3和数据mem [p ..(p + s))t3:u256)</td>
</tr>
<tr>
<td>log4(p:u256, s:u256, t1:u256, t2:u256,</td>
<td>记录主题t1,t2,t3,t4和数据mem [p ..(p + s))t3:u256,t4:u256)</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><em>状态查询</em></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>blockcoinbase() -&gt; address:u256</td>
<td>目前的采矿受益者</td>
</tr>
<tr>
<td>blockdifficulty() -&gt; difficulty:u256</td>
<td>当前块的难度</td>
</tr>
<tr>
<td>blockgaslimit() -&gt; limit:u256</td>
<td>阻止当前块的气体限制</td>
</tr>
<tr>
<td>blockhash(b:u256) -&gt; hash:u256</td>
<td>块nr b的散列值 - 仅适用于不包括当前值的最后256个块</td>
</tr>
<tr>
<td>blocknumber() -&gt; block:u256</td>
<td>当前程序段号</td>
</tr>
<tr>
<td>blocktimestamp() -&gt; timestamp:u256</td>
<td>当前块的时间戳,以秒为单位</td>
</tr>
<tr>
<td>txorigin() -&gt; address:u256</td>
<td>交易发件人</td>
</tr>
<tr>
<td>txgasprice() -&gt; price:u256</td>
<td>交易的天然气价格</td>
</tr>
<tr>
<td>gasleft() -&gt; gas:u256</td>
<td>天然气仍然可以执行</td>
</tr>
<tr>
<td>balance(a:u256) -&gt; v:u256</td>
<td>wei在地址a处平衡</td>
</tr>
<tr>
<td>this() -&gt; address:u256</td>
<td>当前合同/执行上下文的地址</td>
</tr>
<tr>
<td>caller() -&gt; address:u256</td>
<td>呼叫发送者(不包括委托呼叫)</td>
</tr>
<tr>
<td>callvalue() -&gt; v:u256</td>
<td>wei与目前的电话一起发送</td>
</tr>
<tr>
<td>calldataload(p:u256) -&gt; v:u256</td>
<td>从位置p开始的呼叫数据(32字节)</td>
</tr>
<tr>
<td>calldatasize() -&gt; v:u256</td>
<td>通话数据的大小以字节为单位</td>
</tr>
<tr>
<td>calldatacopy(t:u256, f:u256, s:u256)</td>
<td>从位置f的calldata复制s个字节到位置t的mem</td>
</tr>
<tr>
<td>codesize() -&gt; size:u256</td>
<td>当前合同/执行上下文的代码大小</td>
</tr>
<tr>
<td>codecopy(t:u256, f:u256, s:u256)</td>
<td>从位置f的代码复制s字节到位置t的mem</td>
</tr>
<tr>
<td>extcodesize(a:u256) -&gt; size:u256</td>
<td>地址a处代码的大小</td>
</tr>
<tr>
<td>extcodecopy(a:u256, t:u256, f:u256, s:u256)</td>
<td>像代码复制(t,f,s),但需要在地址a处进行编码</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><em>其他</em></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>discardu256(unused:u256)</td>
<td>丢弃价值</td>
</tr>
<tr>
<td>splitu256tou64(x:u256) -&gt; (x1:u64, x2:u64,</td>
<td>将u256分成四个u64:x3:u64,x4:u64)</td>
</tr>
<tr>
<td>combineu64tou256(x1:u64, x2:u64, x3:u64,</td>
<td>将四个u64合并成一个u256:x4:u64) - &gt;(x:u256)</td>
</tr>
<tr>
<td>sha3(p:u256, s:u256) -&gt; v:u256</td>
<td>keccak(mem[p...(p+s)))</td>
</tr>
</tbody>
</table>
<h3 id="_6">后端<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>后端或目标是JULIA到特定字节码的翻译。
每个后端都可以暴露以后端名称为前缀的函数。
我们为两个建议的后端保留<code>evm_</code>和<code>ewasm_</code>前缀。</p>
<h3 id="evm">后端: EVM<a class="headerlink" href="#evm" title="Permanent link">&para;</a></h3>
<p>EVM目标将具有暴露于evm_前缀的所有底层EVM操作码。</p>
<h3 id="evm-15">后端: "EVM 1.5"<a class="headerlink" href="#evm-15" title="Permanent link">&para;</a></h3>
<p>TBD</p>
<h3 id="ewasm">后端:eWASM<a class="headerlink" href="#ewasm" title="Permanent link">&para;</a></h3>
<p>TBD</p>
<h2 id="julia_1">JULIA对象的规范<a class="headerlink" href="#julia_1" title="Permanent link">&para;</a></h2>
<p>语法:</p>
<div class="codehilite"><pre><span></span>    <span class="n">TopLevelObject</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">object</span><span class="sc">&#39; &#39;</span><span class="p">{</span><span class="err">&#39;</span> <span class="n">Code</span><span class="o">?</span> <span class="p">(</span> <span class="n">Object</span> <span class="o">|</span> <span class="n">Data</span> <span class="p">)</span><span class="o">*</span> <span class="sc">&#39;}&#39;</span>
    <span class="n">Object</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">object</span><span class="o">&#39;</span> <span class="n">StringLiteral</span> <span class="sc">&#39;{&#39;</span> <span class="n">Code</span><span class="o">?</span> <span class="p">(</span> <span class="n">Object</span> <span class="o">|</span> <span class="n">Data</span> <span class="p">)</span><span class="o">*</span> <span class="sc">&#39;}&#39;</span>
    <span class="n">Code</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">code</span><span class="o">&#39;</span> <span class="n">Block</span>
    <span class="n">Data</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">data</span><span class="o">&#39;</span> <span class="n">StringLiteral</span> <span class="n">HexLiteral</span>
    <span class="n">HexLiteral</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">hex</span><span class="o">&#39;</span> <span class="p">(</span><span class="sc">&#39;&quot;&#39;</span> <span class="p">([</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="n">a</span><span class="o">-</span><span class="n">fA</span><span class="o">-</span><span class="n">F</span><span class="p">]{</span><span class="mi">2</span><span class="p">})</span><span class="o">*</span> <span class="sc">&#39;&quot;&#39;</span> <span class="o">|</span> <span class="err">&#39;&#39;&#39;</span> <span class="p">([</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="n">a</span><span class="o">-</span><span class="n">fA</span><span class="o">-</span><span class="n">F</span><span class="p">]{</span><span class="mi">2</span><span class="p">})</span><span class="o">*</span> <span class="err">&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">StringLiteral</span> <span class="o">=</span> <span class="sc">&#39;&quot;&#39;</span> <span class="p">([</span><span class="o">^</span><span class="s">&quot;rn] | &#39;&#39; .)* &#39;&quot;</span><span class="err">&#39;</span>
</pre></div>

<p>上面,<code>Block</code>指的是上一章中解释的JULIA代码语法中的<code>Block</code>。</p>
<p>JULIA对象示例如下所示:</p>
<div class="codehilite"><pre><span></span>    <span class="o">//</span> <span class="n">代码由单个对象组成。</span>
    <span class="o">//</span> <span class="n">单个</span><span class="sb">`代码`</span><span class="n">节点是对象的代码。</span>
    <span class="o">//</span> <span class="n">每个</span><span class="p">(</span><span class="n">其他</span><span class="p">)</span><span class="n">命名的对象或数据部分都被序列化并可供特殊内置函数datacopy</span> <span class="o">/</span> <span class="n">dataoffset</span> <span class="o">/</span> <span class="n">datasize访问</span>
    <span class="n">object</span> <span class="p">{</span>
        <span class="n">code</span> <span class="p">{</span>
            <span class="k">let</span> <span class="n">size</span> <span class="o">=</span> <span class="n">datasize</span><span class="p">(</span><span class="s">&quot;runtime&quot;</span><span class="p">)</span>
            <span class="k">let</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">allocate</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
            <span class="o">//</span> <span class="n">这将变成eWASM的内存</span> <span class="o">-</span> <span class="o">&gt;</span><span class="n">内存拷贝</span><span class="p">,</span><span class="n">以及EVM的代码拷贝</span>
            <span class="n">datacopy</span><span class="p">(</span><span class="n">dataoffset</span><span class="p">(</span><span class="s">&quot;runtime&quot;</span><span class="p">),</span> <span class="n">offset</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
            <span class="o">//</span> <span class="n">这是一个构造函数</span><span class="p">,</span><span class="n">返回运行时代码</span>
            <span class="k">return</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">data</span> <span class="s">&quot;Table2&quot;</span> <span class="n">hex</span><span class="s">&quot;4123&quot;</span>

        <span class="n">object</span> <span class="s">&quot;runtime&quot;</span> <span class="p">{</span>
            <span class="n">code</span> <span class="p">{</span>
                <span class="o">//</span> <span class="n">运行时代码</span>
                <span class="k">let</span> <span class="n">size</span> <span class="o">=</span> <span class="n">datasize</span><span class="p">(</span><span class="s">&quot;Contract2&quot;</span><span class="p">)</span>
                <span class="k">let</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">allocate</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
                <span class="o">//</span> <span class="n">这将变成eWASM的内存</span> <span class="o">-</span> <span class="o">&gt;</span><span class="n">内存拷贝</span><span class="p">,</span><span class="n">以及EVM的代码拷贝</span>
                <span class="n">datacopy</span><span class="p">(</span><span class="n">dataoffset</span><span class="p">(</span><span class="s">&quot;Contract2&quot;</span><span class="p">),</span> <span class="n">offset</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
                <span class="o">//</span> <span class="n">构造函数参数是单个数字0x1234</span>
                <span class="n">mstore</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">size</span><span class="p">),</span> <span class="mh">0x1234</span><span class="p">)</span>
                <span class="n">create</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">add</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
            <span class="p">}</span>

            <span class="o">//</span> <span class="n">嵌入对象。</span>
            <span class="o">//</span> <span class="n">用例是外部是工厂合同</span><span class="p">,</span><span class="n">Contract2是工厂创建的代码</span>
            <span class="n">object</span> <span class="s">&quot;Contract2&quot;</span> <span class="p">{</span>
                <span class="n">code</span> <span class="p">{</span>
                    <span class="o">//</span> <span class="n">代码在这里</span><span class="o">..</span>
                <span class="p">}</span>

                <span class="n">object</span> <span class="s">&quot;runtime&quot;</span> <span class="p">{</span>
                    <span class="n">code</span> <span class="p">{</span>
                        <span class="o">//</span> <span class="n">代码在这里</span><span class="o">...</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="n">data</span> <span class="s">&quot;Table1&quot;</span> <span class="n">hex</span><span class="s">&quot;4123&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../abi-spec/" title="接口规范" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                接口规范
              </span>
            </div>
          </a>
        
        
          <a href="../style-guide/" title="样式指南" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                样式指南
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            版权 &copy; 2018 -  wohugb.github.io
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="http://wohugb.github.io" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/wohugb" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/wohugb" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/wohugb" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.6cdc17f0.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              <script src="../assets/javascripts/lunr/lunr.zh.js"></script>
            
          
          
        
      
      <script>app.initialize({version:"0.17.2",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>